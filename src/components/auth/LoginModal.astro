---
import AnonymousSignInForm from "./AnonymousSignInForm.astro";
import GoogleSignInBtn from "./GoogleSignInBtn.astro";

/**
 * This component will auto open, if user isn't logged in
 */
---

<dialog
  id="login-modal"
  class="font-mono backdrop:bg-black backdrop:opacity-50"
>
  <div id="login-modal-content" class="px-4 py-2">
    <h2 class="text-center font-semibold text-2xl md:text-3xl mb-4">
      Login to use Talki
    </h2>
    <div class="flex flex-col gap-y-2 items-center">
      <AnonymousSignInForm />
      <div class="font-bold">or</div>
      <GoogleSignInBtn />
    </div>
  </div>
</dialog>
<script>
  const loginModal = document.getElementById(
    "login-modal"
    // eslint-disable-next-line prettier/prettier
  ) as HTMLDialogElement;

  loginModal.showModal(); // todo: change this to check whether already logged in
  loginModal.addEventListener("click", closeModalIfOverlayClicked);

  function closeModalIfOverlayClicked(e: MouseEvent) {
    const isClickOnOverlay = e.target === loginModal;
    if (isClickOnOverlay) loginModal.close();
  }
</script>
